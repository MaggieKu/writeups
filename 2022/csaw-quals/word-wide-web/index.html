<!DOCTYPE html>
<html lang="en">
	<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>RiceSec</title>

	<link href="/writeups/css/prism-one-light.css" rel="stylesheet" />
	<link rel="stylesheet" href="/writeups/css/style.css" />
</head>


	<body>
		
<header>
	<nav>
		<b>RiceSec</b>
	</nav>
</header>

<h1>word-wide-web</h1>

<p>This challenge has a chain of links. Every page has one valid link among several broken ones (without <code>href</code> attributes). We can write a script to traverse through the chain.</p>
<p>Additionally, the pages require that you include a cookie that describes the path along the solution until that page, lest, else it just says &quot;Booooo!&quot;.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> jsdom <span class="token keyword">from</span> <span class="token string">'jsdom'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> got <span class="token keyword">from</span> <span class="token string">'got'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token constant">HOST</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token constant">PORT</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><br><br><span class="token keyword">let</span> path <span class="token operator">=</span> <span class="token string">'/'</span><span class="token punctuation">;</span><br><span class="token keyword">let</span> solChain <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><br><br><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">got</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">HOST</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">PORT</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>		<span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>			<span class="token string-property property">'Cookie'</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">solChain=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>solChain<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span><br>		<span class="token punctuation">}</span><br>	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">const</span> <span class="token punctuation">{</span>body<span class="token punctuation">}</span> <span class="token operator">=</span> res<span class="token punctuation">;</span><br>	<span class="token keyword">const</span> <span class="token punctuation">{</span>document<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">jsdom<span class="token punctuation">.</span>JSDOM</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>window<span class="token punctuation">;</span><br>	<span class="token keyword">const</span> link <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'a[href]'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>	path <span class="token operator">=</span> link<span class="token punctuation">.</span>href<span class="token punctuation">;</span><br>	solChain <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">%20</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p>The script errors out when <code>link</code> is <code>null</code>, at which point we can just manually check the last-link for the flag.</p>



	</body>
</html>
